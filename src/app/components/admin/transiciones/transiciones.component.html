<div *ngIf="tramites">
    <div class="col-md-4">
        <div class="mt-3">
            <h2>Todos los trámites</h2>
        </div>
    </div>
    <table class="table table-striped" >
        <thead>
            <tr>
                <th>Último Tramite</th>
                <th>N° Expediente</th>
                <th>Fecha</th>
                <th>Sector</th>
                <th>Opciones</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let historial of tramites?.results | paginate: { itemsPerPage: 5, currentPage: p, totalItems: tramites.count }">
                <td>{{ historial.tramite.numero }}{{ historial.tramite.codigo_verificacion }}</td>
                <td>{{ historial.tramite.expediente.numero }}-{{ historial.tramite.expediente.anio }}</td>
                <td>{{ historial.fecha_entrada | date:'short' }}</td>
                <td *ngIf="isAdmin; else tdsector">
                    <select id="sectores" (change)="onChange($event.target.value)" [multiple]="false" [closeOnSelect]="true">
                        <option value="" [selected]="true" disabled>{{ historial.transicion.sector_sucesor.nombre }}</option>
                        <option *ngFor="let sector of sectores" [value]="[sector.id,historial.tramite.id, historial.transicion.tipo_expediente.id]">{{sector.nombre}}</option>
                    </select>  
                </td>
                <ng-template #tdsector>
                    <td>{{historial.transicion.sector_sucesor.nombre}}</td>
                </ng-template>
                
                <td>
                    <a class="mx-1" [routerLink]="['/expediente/', historial.tramite.expediente.id ]" >
                        <span style="color: gray;">
                            <svg id="i-info" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="20" height="20" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                            <path d="M16 14 L16 23 M16 8 L16 10" />
                            <circle cx="16" cy="16" r="14" />
                            </svg>
                        </span>
                    </a>
                    <a  *ngIf="isAdmin || isEmpleadoME" class="mx-1" (click)="eliminar(historial.tramite.expediente.id)" >
                        <span style="color: rgb(248, 86, 86);">
                            <svg id="i-trash" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="20" height="20" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                                <path d="M28 6 L6 6 8 30 24 30 26 6 4 6 M16 12 L16 24 M21 12 L20 24 M11 12 L12 24 M12 6 L13 2 19 2 20 6" />
                            </svg>
                        </span>
                    </a>
                    <a *ngIf="isAdmin || isEmpleadoME" class="mx-1" [routerLink]="['/expediente/editar/', historial.tramite.expediente.id ]"  >
                        <span style="color: rgb(248, 152, 9);">
                            <svg id="i-edit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="20" height="20" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                                <path d="M30 7 L25 2 5 22 3 29 10 27 Z M21 6 L26 11 Z M5 22 L10 27 Z" />
                            </svg>
                        </span>
                    </a>
                </td>
            </tr>
        </tbody>
    </table>

    <div class="d-flex justify-content-center">
        <pagination-controls class="paginator" (pageChange)="onTableDataChange($event)"></pagination-controls>
    </div>

</div> 
<ngx-spinner></ngx-spinner>

<swal #mensajeSwal title icon confirmButtonText cancelButtonText showCancelButton cancelButtonColor confirmButtonColor confirm></swal>