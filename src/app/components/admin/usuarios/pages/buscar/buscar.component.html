
<div class="container">
    
    <div class="row">
        <h1 style="font-weight: bold;">Consulta de Usuarios</h1>
    </div>
    
    <br>


   
    
    <form [formGroup]="consultaForm">
        <div class="row">
            <div class="col-lg-4 col-md-4 col-sm-12">
                <label for="username" class="form-label">Consultar por</label>   
                <select formControlName="param_busqueda" class="form-select" aria-label="Default select example">
                    <option *ngFor="let cat of categories" [ngValue]="cat.value">{{cat.name}}</option>
                </select>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-12">
                <label for="username" class="form-label">Número de {{consultaForm.value.param_busqueda}}</label>
                <input  (keyup.enter)="buscarUsuario()" formControlName="numero" maxlength="10" inputmode="numeric" placeholder="Número" class="form-control" autocomplete="off">
            </div>
            
            <div class="col-md-4">
                <div class="mt-3">
                    <div class="row">
                        <div class="col-md-6">
                            <button type="button" (click)="buscarUsuario()" class="btn btn-green">Buscar</button>
                        </div>
                        <div class="col-md-6">
                            <button routerLink="/usuario/agregar" type="button" class="btn btn-green">Nuevo</button>
                        </div>
                    </div>
                </div> 
            </div>
        </div>


        <hr />

        <div class="row" *ngIf="isAdmin">


            <div class="col-lg-4 col-md-4 col-sm-12">
                <label for="username" class="form-label">Nombre</label>
                <input  formControlName="nombre" maxlength="5" inputmode="numeric" placeholder="Nombre de Usuario" class="form-control" autocomplete="off">
            </div>
            

            <div class="col-md-4">
                <label for="username" class="form-label">ROL</label>
                <select formControlName="rol" class="form-select" *ngIf="roles">
                    <option [value]="dato.url" *ngFor="let dato of roles.results" value="">{{dato.nombre}}</option>
                </select>
            </div>

            <div class="col-md-4">
                <label for="username" class="form-label">Matricula</label>
                <input  formControlName="matricula" maxlength="20" inputmode="numeric" placeholder="Matricula" class="form-control" autocomplete="off">
            </div>
        

            <div class="col-md-4 ">
                <div class="mt-3">
                    <button type="button" [type]="submit" class="btn btn-green">Consultar</button>
                </div>
            </div>
        </div>
    </form>
    
    <hr/>

    <div *ngIf="usuarios">
        <table class="table table-striped" >
            <thead>
                <tr>
                    <th>Nombre y Apellido</th>
                    <th>CUIT</th>
                    <th>Email</th>
                    <th>Estado</th>
                    <th>Opciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let usr of usuarios.results | paginate: { itemsPerPage: 10, currentPage: p, totalItems: usuarios.count }">

                    <td>{{ usr.nombre }} {{ usr.apellido }}</td>
                    <td>{{ usr.cuit }}</td>
                    <td>{{ usr.email }}</td>
                    <td><b>Estado</b></td>
                    <td>
                        <a [routerLink]="['/usuario/', usr.id ]" ><span style="color: white; background-color: black; padding: 5px 10px 5px 10px; border-radius: 100px;"><i class="fa fa-info"></i></span></a>
                        <a (click)="eliminar(usr.id)" ><span style="color: rgb(248, 9, 9); padding: 10px; border-radius: 50px;"><i class="fa fa-times"></i></span></a>
                        <!-- <a (click)="eliminar(user.id)" ><span><span style="color: rgb(248, 152, 9); padding: 10px; border-radius: 50px;"><i class="fas fa-undo"></i></span></span></a> -->
                    </td>
                </tr>
            </tbody>
        </table>


        <div class="d-flex justify-content-center">

            <pagination-controls (pageChange)="onTableDataChange($event)"></pagination-controls>


        </div>

        <div class="col-md-4">
            <div class="mt-3">
               
                <button type="button" class="btn btn-green float-right">Limpiar</button>
            </div>
        </div>
    
        <!-- <div class="col-lg-12">
            <button [ngClass]="{'disabled': btnActive == false}" class="btn buttons btn-green m-1" type="button" (click)="confirmar()">Confirmar</button>
            <div class="btn buttons m-1">
                Total: ${{ (totalImporte/100).toFixed(2) }}
            </div>
        </div> -->

        

    </div> 



</div>



<hr>

<pre>{{ closeResult }}</pre>

<swal #mensajeSwal title icon confirmButtonText cancelButtonText showCancelButton cancelButtonColor confirmButtonColor confirm></swal>
<ngx-spinner></ngx-spinner>